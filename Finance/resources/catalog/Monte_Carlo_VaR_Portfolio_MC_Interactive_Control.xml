<?xml version="1.0" encoding="UTF-8"?>
<job
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="urn:proactive:jobdescriptor:3.14" xsi:schemaLocation="urn:proactive:jobdescriptor:3.14 http://www.activeeon.com/public_content/schemas/proactive/jobdescriptor/3.14/schedulerjob.xsd"  name="Monte_Carlo_VaR_Portfolio_MC_Interactive_Control" projectName="Risk Valuation Workflows" tags="QuantLib,Cpp,Finance,VaR,Pricing,Bale,Risk,Solvency,Black-Scholes" priority="normal" onTaskError="cancelJob"  maxNumberOfExecution="1"  >
  <variables>
    <variable name="nb_MC" value="10000"  description="The number of Monte Carlo simulations." group="Simulation"  />
    <variable name="nb_time_steps" value="255"  description="The number of time steps to the horizon." group="Simulation"  />
    <variable name="horizon" value="1"  description="The horizon in year fraction." group="Simulation"  />
    <variable name="assets_params_file_path_from_dataspace" value="assets.txt"  description="The relative path from the dataspace of the asset params file following the csv format." group="Simulation"  />
    <variable name="assets_correlations_file_path_from_dataspace" value="assets_correlations.txt"  description="The relative path from the dataspace of the asset correlations file." group="Simulation"  />
    <variable name="confidence_rate" value="0.99"  description="The confidence level rate." group="VaR"  />
    <variable name="nb_bins" value="200"  description="The number of bins for the portfolio estimation distributions." group="VaR"  />
    <variable name="nb_tasks" value="5"  description="The number of ProActive replicated tasks." group="Parallelization"  />
    <variable name="TARGETED_PA_NODE_SOURCE_NAME" value="" model="PA:MODEL_FROM_URL(${PA_SCHEDULER_REST_PUBLIC_URL}/rm/model/nodesources)" description="The node source where the job will be executed." group="Parallelization"/>
    <variable name="width_chart" value="1000"  description="The width of the chart in pixels." group="Display"  />
    <variable name="height_chart" value="500"  description="The height of the chart in pixels." group="Display"  />
  </variables>
  <description>
    <![CDATA[ Estimates the Monte Carlo Value at Risk (MC VaR) of a portfolio. We use the Geometric Brownian motion (GBM) method to simulate stock price paths, but more advanced assets can be integrated thanks to the C++ Quantlib lib. After the VaR estimation, user can rerun/trigger more simualations to improve the VaR accuracy and smooth the bar chart. ]]>
  </description>
  <genericInformation>
    <info name="bucketName" value="hpc-finance"/>
    <info name="workflow.icon" value="/automation-dashboard/styles/patterns/img/wf-icons/quantlib.png"/>
    <info name="Documentation" value="https://ow2-proactive.github.io/proactive-examples/Finance/resources/doc/risk-valuation-proactive.pdf"/>
    <info name="group" value="public-objects"/>
  </genericInformation>
  <taskFlow>
    <task name="split_MC_simulations"




          fork="true">
      <depends>
        <task ref="Start"/>
      </depends>
      <inputFiles>
        <files  includes="$assets_params_file_path_from_dataspace" accessMode="transferFromGlobalSpace"/>
      </inputFiles>
      <scriptExecutable>
        <script>
          <code language="groovy">
            <![CDATA[
println "Split_MC_simulations ..."

// Retrieve variables
def nb_MC = variables.get("nb_MC").toInteger()
def nb_tasks = variables.get("nb_tasks").toInteger()
def assets_params_file_path_from_dataspace = variables.get("assets_params_file_path_from_dataspace")

// Estimate nb_MC per task
def nbMC_per_task = (int)(nb_MC / nb_tasks)
if (nb_MC % nb_tasks != 0)
	nbMC_per_task++

def nbMC_left = nb_MC
def nbMC_task = 0
(0..nb_tasks-1).each {
     // How many simulations must we give?
     if(it == nb_tasks-1)
     	nbMC_task = nbMC_left
     else
  	    nbMC_task = nbMC_per_task

     // Update nbMC_left
     nbMC_left = nbMC_left - nbMC_task

     // Store nbMC_task
     variables["nbMC_task_${it}"] = nbMC_task
     println "nbMC_task " + nbMC_task
}

// Estimate the number of assets
variables["nbAssets"] = new File(localspace, assets_params_file_path_from_dataspace).text.split(System.getProperty("line.separator")).length

println "... Split_MC_simulations"
]]>
          </code>
        </script>
      </scriptExecutable>
      <controlFlow >
        <replicate>
          <script>
            <code language="groovy">
              <![CDATA[
runs=variables.get("nb_tasks")
]]>
            </code>
          </script>
        </replicate>
      </controlFlow>
      <metadata>
        <positionTop>
          41.474998474121094
        </positionTop>
        <positionLeft>
          503.375
        </positionLeft>
      </metadata>
    </task>
    <task name="simulate_ptf_PnLs"




          fork="true">
      <genericInformation>
        <info name="task.icon" value="/automation-dashboard/styles/patterns/img/wf-icons/quantlib.png"/>
      </genericInformation>
      <depends>
        <task ref="split_MC_simulations"/>
      </depends>
      <inputFiles>
        <files  includes="ptfPnLSimulations" accessMode="transferFromGlobalSpace"/>
        <files  includes="$assets_params_file_path_from_dataspace" accessMode="transferFromGlobalSpace"/>
        <files  includes="$assets_correlations_file_path_from_dataspace" accessMode="transferFromGlobalSpace"/>
        <files  includes="outputs_job_${PA_JOB_ID}_task_${PA_TASK_REPLICATION}.txt" accessMode="transferFromGlobalSpace"/>
      </inputFiles>
      <selection>
        <script type="dynamic">
          <code language="groovy">
            <![CDATA[
selected = false
TASK_NAME = variables.get("PA_TASK_NAME")
TASK_NODE_SOURCE_NAME = variables.get("TASK_NODE_SOURCE_NAME")
if (TASK_NODE_SOURCE_NAME?.trim()) {
    selected = TASK_NODE_SOURCE_NAME.equals(System.getProperty("proactive.node.nodesource"))
} else {
    selected = true
}
]]>
          </code>
        </script>
      </selection>
      <scriptExecutable>
        <script>
          <code language="groovy">
            <![CDATA[
println "simulate_ptf_PnLs ..."

// Retrieve variables
def job_id = variables.get("PA_JOB_ID")
def task_id = variables.get("PA_TASK_REPLICATION")
def nbMC_task = variables.get("nbMC_task_" + task_id)
def nb_time_steps = variables.get("nb_time_steps")
def horizon = variables.get("horizon")
def nbAssets = variables.get("nbAssets")
def assets_params_file_path_from_dataspace = variables.get("assets_params_file_path_from_dataspace")
def assets_correlations_file_path_from_dataspace = variables.get("assets_correlations_file_path_from_dataspace")

// Set executable permission
def executable_file_path = new File(localspace, "ptfPnLSimulations").absolutePath
["chmod","+x", executable_file_path].execute().waitForProcessOutput(System.out, System.err)

// Build the command
def cmd = ['/bin/sh', '-c', "docker run --rm -v " + localspace + ":" + localspace + " -w " + localspace + " activeeon/quantlib:1.19 /bin/bash -c './ptfPnLSimulations " + nbMC_task + " " + nb_time_steps + " " + horizon + " " + nbAssets + " " + assets_params_file_path_from_dataspace + " " +  assets_correlations_file_path_from_dataspace + " " + task_id + "'"]
println cmd

// Execute the command
def sout = new StringBuilder()
cmd.execute().waitForProcessOutput(sout, System.err)

// Store ptf PnLs at horizon (or append to previous wkw reexecutions results)
def output_file_name = "outputs_job_" + job_id + "_task_" + task_id + ".txt"
def output_file = new File(localspace, output_file_name)
if (output_file.exists()){
  output_file.append(sout)
} else {
  output_file.text = sout
}

println "... simulate_ptf_PnLs"
]]>
          </code>
        </script>
      </scriptExecutable>
      <outputFiles>
        <files  includes="outputs_job_${PA_JOB_ID}_task_${PA_TASK_REPLICATION}.txt" accessMode="transferToGlobalSpace"/>
      </outputFiles>
      <metadata>
        <positionTop>
          169.4749984741211
        </positionTop>
        <positionLeft>
          498.375
        </positionLeft>
      </metadata>
    </task>
    <task name="process_VaR_and_put_signal"



          preciousResult="true"
          fork="true">
      <depends>
        <task ref="simulate_ptf_PnLs"/>
      </depends>
      <inputFiles>
        <files  includes="DualAxisChart.jar" accessMode="transferFromGlobalSpace"/>
        <files  includes="jcommon-1.0.6.jar" accessMode="transferFromGlobalSpace"/>
        <files  includes="jfreechart-1.0.2.jar" accessMode="transferFromGlobalSpace"/>
        <files  includes="outputs_job_${PA_JOB_ID}_task_*.txt" accessMode="transferFromGlobalSpace"/>
      </inputFiles>
      <forkEnvironment >
        <additionalClasspath>
          <pathElement path="DualAxisChart.jar"/>
          <pathElement path="jcommon-1.0.6.jar"/>
          <pathElement path="jfreechart-1.0.2.jar"/>
        </additionalClasspath>
      </forkEnvironment>
      <scriptExecutable>
        <script>
          <code language="groovy">
            <![CDATA[
import DualAxisChart;

println "process_VaR ..."

// Retrieve variables
def job_id = variables.get("PA_JOB_ID")
def horizon = variables.get("horizon").toInteger()
def confidence_rate = variables.get("confidence_rate").toDouble()
def nb_bins = variables.get("nb_bins").toInteger()
def chart_file_path_from_dataspace = variables.get("chart_file_path_from_dataspace")
def width_chart = variables.get("width_chart").toInteger()
def height_chart = variables.get("height_chart").toInteger()

// Retrieve ptf PnLs at horizon from all tasks
def ptfHorizonPnLs = []
def MCid = 0

// Retrieve all task result files
new File(localspace).eachFileMatch(~/outputs_job_${job_id}_task_\d+.txt/) {task_results_file ->

  println "Reading ... " + task_results_file.name

  task_results_file.text.split().each{ ptfHorizonPnL ->
		ptfHorizonPnLs += ptfHorizonPnL.toDouble()
		MCid++;
  }
}
println "nb MC simus retrived from tasks: " + MCid

// Compute VaR
ptfHorizonPnLs = ptfHorizonPnLs.sort()
def VaRIndex = (int)((1 - confidence_rate) * MCid);
def VaR = ptfHorizonPnLs[VaRIndex]

def resultStr = "portfolio VaR " + confidence_rate*100 + "% at horizon " + horizon + " = " + VaR + " (" + MCid + " simus)"
println resultStr
def chart_file_name = "VaR.png"
DualAxisChart.writeChart(resultStr, ptfHorizonPnLs as double[], nb_bins, VaR, chart_file_name, width_chart, height_chart)

// Expose the resulting chart image
def chart_file = new File(localspace, chart_file_name)
result = chart_file.getBytes()
resultMetadata.put("file.name", chart_file_name)
resultMetadata.put("content.type", "image/png")

// Put signal for interactive control
variables.put("waitForSignals", true)

println "... process_VaR"
]]>
          </code>
        </script>
      </scriptExecutable>
      <metadata>
        <positionTop>
          297.4749984741211
        </positionTop>
        <positionLeft>
          498.375
        </positionLeft>
      </metadata>
    </task>
    <task name="Wait_For_Signals_With_Variables"




          fork="true">
      <description>
        <![CDATA[ A template task that sends a ready notification for all the signals specified in the variable SIGNALS, then loops until one signal among those specified is received by the job. ]]>
      </description>
      <variables>
        <variable name="SIGNALS" value="stop, kill" inherited="false"  description="List of comma-separated signals expected by this task."  advanced="false" hidden="false"/>
      </variables>
      <genericInformation>
        <info name="task.icon" value="/automation-dashboard/styles/patterns/img/wf-icons/signal-wait.png"/>
        <info name="TASK.DOCUMENTATION" value="user/ProActiveUserGuide.html#_task_signal_api"/>
      </genericInformation>
      <depends>
        <task ref="process_VaR_and_put_signal"/>
      </depends>
      <scriptExecutable>
        <script>
          <code language="groovy">
            <![CDATA[
import org.ow2.proactive.scheduler.common.job.JobVariable
import java.util.*;

if (variables.get("waitForSignals")){

List <JobVariable> signalVariables = new java.util.ArrayList<JobVariable>()
signalVariables.add(new JobVariable("nb_MC", "" + variables.get("nb_MC"), "PA:INTEGER", "The number of Monte Carlo simulations.", "", false, false))
signalVariables.add(new JobVariable("nb_tasks", "" + variables.get("nb_tasks"), "PA:INTEGER", "The number of ProActive replicated tasks.", "", false, false))
signalVariables.add(new JobVariable("TARGETED_PA_NODE_SOURCE_NAME", "" + variables.get("TARGETED_PA_NODE_SOURCE_NAME"), "PA:MODEL_FROM_URL(\${PA_SCHEDULER_REST_PUBLIC_URL}/rm/model/nodesources?infrastructure=%5E(%3F!(Default)).*\$)", "The node source where the job will be executed.", "", false, false))

signalapi.readyForSignal("Terminate_Job")
signalapi.readyForSignal("Add_more_MC_simulations", signalVariables)

variables.put("Terminate_Job", false)
}
variables.put("waitForSignals", false)

signals = new HashSet()
signals.add("Terminate_Job")
signals.add("Add_more_MC_simulations")

receivedSignals = signalapi.checkForSignals(signals)

println "Received signal = " + receivedSignals.keySet()

if(receivedSignals.keySet().contains("Terminate_Job")){
    variables.put("Terminate_Job", true)
	result = receivedSignals.keySet().toString()
} else {
    if(receivedSignals.keySet().contains("Add_more_MC_simulations")){
    	updatedVariables = receivedSignals.get("Add_more_MC_simulations")
    	variables.put("nb_MC", updatedVariables.get("nb_MC"))
    	variables.put("nb_tasks", updatedVariables.get("nb_tasks"))
    	variables.put("TARGETED_PA_NODE_SOURCE_NAME", updatedVariables.get("TARGETED_PA_NODE_SOURCE_NAME"))
    	signalapi.removeSignal("ready_Terminate_Job")
        result = receivedSignals.keySet().toString()
        variables.put("PA_TASK_ITERATION", 0)
    }
    else{
        result = null
    }
}
]]>
          </code>
        </script>
      </scriptExecutable>
      <controlFlow >
        <loop target="Wait_For_Signals_With_Variables">
          <script>
            <code language="groovy">
              <![CDATA[
if (result!=null){
    loop = false
} else {
    loop = "* * * * *"
}
]]>
            </code>
          </script>
        </loop>
      </controlFlow>
      <metadata>
        <positionTop>
          425.4749984741211
        </positionTop>
        <positionLeft>
          498.375
        </positionLeft>
      </metadata>
    </task>
    <task name="Rerun_Simulation"




          fork="true">
      <description>
        <![CDATA[ A template task that waits for a Signal with variables, allowing to rerun the loop with new variable values. ]]>
      </description>
      <genericInformation>
        <info name="task.icon" value="/automation-dashboard/styles/patterns/img/wf-icons/signal-send.png"/>
      </genericInformation>
      <depends>
        <task ref="Wait_For_Signals_With_Variables"/>
      </depends>
      <scriptExecutable>
        <script>
          <code language="groovy">
            <![CDATA[

]]>
          </code>
        </script>
      </scriptExecutable>
      <controlFlow  block="end">
        <loop target="Start">
          <script>
            <code language="groovy">
              <![CDATA[
loop = ! variables.get("Terminate_Job")
]]>
            </code>
          </script>
        </loop>
      </controlFlow>
      <metadata>
        <positionTop>
          551.4749984741211
        </positionTop>
        <positionLeft>
          647.375
        </positionLeft>
      </metadata>
    </task>
    <task name="Start"




          fork="true">
      <scriptExecutable>
        <script>
          <code language="groovy">
            <![CDATA[
]]>
          </code>
        </script>
      </scriptExecutable>
      <controlFlow block="start"></controlFlow>
      <metadata>
        <positionTop>
          16.462501525878906
        </positionTop>
        <positionLeft>
          749.125
        </positionLeft>
      </metadata>
    </task>
  </taskFlow>
  <metadata>
    <visualization>
      <![CDATA[ <html>
    <head>
    <link rel="stylesheet" href="/studio/styles/studio-standalone.css">
        <style>
        #workflow-designer {
            left:0 !important;
            top:0 !important;
            width:2256px;
            height:2579px;
            }
        </style>
    </head>
    <body>
    <div id="workflow-visualization-view"><div id="workflow-visualization" style="position:relative;top:-11.462501525878906px;left:-493.375px"><div class="task ui-draggable _jsPlumb_endpoint_anchor_" id="jsPlumb_1_596" style="top: 41.475px; left: 503.375px;"><a class="task-name" data-toggle="tooltip" data-placement="right" title="This task has no description"><img src="/studio/images/Groovy.png" width="20px">&nbsp;<span class="name">split_MC_simulations</span></a>&nbsp;&nbsp;<a id="called-icon-a" href="javascript:void(0)" class="pointer" style=" position: inherit; top: 17px; right: 3px;"><i id="called-icon"></i></a></div><div class="task ui-draggable _jsPlumb_endpoint_anchor_" id="jsPlumb_1_599" style="top: 169.475px; left: 498.375px;"><a class="task-name" data-toggle="tooltip" data-placement="right" title="This task has no description"><img src="/automation-dashboard/styles/patterns/img/wf-icons/quantlib.png" width="20px">&nbsp;<span class="name">simulate_ptf_PnLs</span></a>&nbsp;&nbsp;<a id="called-icon-a" href="javascript:void(0)" class="pointer" style=" position: inherit; top: 17px; right: 3px;"><i id="called-icon"></i></a></div><div class="task ui-draggable _jsPlumb_endpoint_anchor_" id="jsPlumb_1_602" style="top: 297.475px; left: 498.375px;"><a class="task-name" data-toggle="tooltip" data-placement="right" title="This task has no description"><img src="/studio/images/Groovy.png" width="20px">&nbsp;<span class="name">process_VaR_and_put_signal</span></a>&nbsp;&nbsp;<a id="called-icon-a" href="javascript:void(0)" class="pointer" style=" position: inherit; top: 17px; right: 3px;"><i id="called-icon"></i></a></div><div class="task ui-draggable _jsPlumb_endpoint_anchor_" id="jsPlumb_1_605" style="top: 425.475px; left: 498.375px;"><a class="task-name" data-toggle="tooltip" data-placement="right" title="A template task that sends a ready notification for all the signals specified in the variable SIGNALS, then loops until one signal among those specified is received by the job."><img src="/automation-dashboard/styles/patterns/img/wf-icons/signal-wait.png" width="20px">&nbsp;<span class="name">Wait_For_Signals_With_Variables</span></a>&nbsp;&nbsp;<a id="called-icon-a" href="javascript:void(0)" class="pointer" style=" position: inherit; top: 17px; right: 3px;"><i id="called-icon"></i></a></div><div class="task block-end ui-draggable _jsPlumb_endpoint_anchor_ active-task" id="jsPlumb_1_608" style="top: 551.475px; left: 647.375px; z-index: 24;"><a class="task-name" data-toggle="tooltip" data-placement="right" title="A template task that waits for a Signal with variables, allowing to rerun the loop with new variable values."><img src="/automation-dashboard/styles/patterns/img/wf-icons/signal-send.png" width="20px">&nbsp;<span class="name">Rerun_Simulation</span></a>&nbsp;&nbsp;<a id="called-icon-a" href="javascript:void(0)" class="pointer" style=" position: inherit; top: 17px; right: 3px;"><i id="called-icon"></i></a></div><div class="task block-start ui-draggable _jsPlumb_endpoint_anchor_" id="jsPlumb_1_611" style="top: 16.475px; left: 749.125px; z-index: 24;"><a class="task-name" data-toggle="tooltip" data-placement="right" title="This task has no description"><img src="/studio/images/Groovy.png" width="20px">&nbsp;<span class="name">Start</span></a>&nbsp;&nbsp;<a id="called-icon-a" href="javascript:void(0)" class="pointer" style=" position: inherit; top: 17px; right: 3px;"><i id="called-icon"></i></a></div><svg style="position:absolute;left:560px;top:-9.5px" width="249.625" height="116.4749984741211" pointer-events="none" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml" class="_jsPlumb_connector"><path d="M 0 0 C -10 -50 238.625 65.4749984741211 228.625 15.474998474121094 " transform="translate(10.5,50.5)" pointer-events="visibleStroke" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="none" stroke="#666" style=""></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M36.90999334375,-11.047410033422471 L57.83323183275198,-14.396751928832138 L50.688929385332855,-8.569321745655241 L55.35514354498474,-0.6178158872492885 L36.90999334375,-11.047410033422471" class="" stroke="#666" fill="#666" transform="translate(10.5,50.5)"></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M36.90999334375,-11.047410033422471 L57.83323183275198,-14.396751928832138 L50.688929385332855,-8.569321745655241 L55.35514354498474,-0.6178158872492885 L36.90999334375,-11.047410033422471" class="" stroke="#666" fill="#666" transform="translate(10.5,50.5)"></path></svg><svg style="position:absolute;left:585.9px;top:70.5px" width="35.60000000000002" height="99" pointer-events="none" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml" class="_jsPlumb_connector "><path d="M 0 88 C -10 88 24.600000000000023 -10 14.600000000000023 0 " transform="translate(10.5,10.5)" pointer-events="visibleStroke" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="none" stroke="#e5db3d" style=""></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M-1.2255011999999978,76.942366 L9.365661024063318,58.58951110645349 L1.3734868694213165,63.18572175021998 L-4.390983225716702,55.99052303703218 L-1.2255011999999978,76.942366" class="" stroke="rgba(229,219,61,0.5)" fill="rgba(229,219,61,0.5)" transform="translate(10.5,10.5)"></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M-1.2255011999999978,76.942366 L9.365661024063318,58.58951110645349 L1.3734868694213165,63.18572175021998 L-4.390983225716702,55.99052303703218 L-1.2255011999999978,76.942366" class="" stroke="rgba(229,219,61,0.5)" fill="rgba(229,219,61,0.5)" transform="translate(10.5,10.5)"></path></svg><div class="_jsPlumb_overlay l1 component label" id="jsPlumb_1_622" style="position: absolute; transform: translate(-50%, -50%); left: 603.2px; top: 120.75px;">replicate</div><svg style="position:absolute;left:549px;top:80.5px" width="32" height="89" pointer-events="none" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml" class="_jsPlumb_connector "><path d="M 0 88 C -10 38 21 50 11 0 " transform="translate(10.5,0.5)" pointer-events="visibleStroke" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="none" stroke="#666" style=""></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M-1.8930240000000003,66.303232 L8.476136957551759,47.824040972349884 L0.539947820500627,52.5162581434697 L-5.310836898978539,45.39106915184926 L-1.8930240000000003,66.303232" class="" stroke="#666" fill="#666" transform="translate(10.5,0.5)"></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M-1.8930240000000003,66.303232 L8.476136957551759,47.824040972349884 L0.539947820500627,52.5162581434697 L-5.310836898978539,45.39106915184926 L-1.8930240000000003,66.303232" class="" stroke="#666" fill="#666" transform="translate(10.5,0.5)"></path></svg><svg style="position:absolute;left:549px;top:208.5px" width="48" height="89" pointer-events="none" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml" class="_jsPlumb_connector "><path d="M 27 88 C 37 38 -10 50 0 0 " transform="translate(10.5,0.5)" pointer-events="visibleStroke" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="none" stroke="#666" style=""></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M27.41933025,65.8307285 L26.57638206964205,44.65788177677379 L22.27241606430647,52.81115575873439 L13.556809328376433,49.804795962467324 L27.41933025,65.8307285" class="" stroke="#666" fill="#666" transform="translate(10.5,0.5)"></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M27.41933025,65.8307285 L26.57638206964205,44.65788177677379 L22.27241606430647,52.81115575873439 L13.556809328376433,49.804795962467324 L27.41933025,65.8307285" class="" stroke="#666" fill="#666" transform="translate(10.5,0.5)"></path></svg><svg style="position:absolute;left:576px;top:336.5px" width="28" height="89" pointer-events="none" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml" class="_jsPlumb_connector "><path d="M 7 88 C 17 38 -10 50 0 0 " transform="translate(10.5,0.5)" pointer-events="visibleStroke" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="none" stroke="#666" style=""></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M9.235168,66.303232 L13.724569009562899,45.59465217000355 L7.514881717901915,52.40932631773681 L-0.1693366727002843,47.314938452101636 L9.235168,66.303232" class="" stroke="#666" fill="#666" transform="translate(10.5,0.5)"></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M9.235168,66.303232 L13.724569009562899,45.59465217000355 L7.514881717901915,52.40932631773681 L-0.1693366727002843,47.314938452101636 L9.235168,66.303232" class="" stroke="#666" fill="#666" transform="translate(10.5,0.5)"></path></svg><svg style="position:absolute;left:669.0266769263776px;top:374.5px" width="20.473323073622403" height="141" pointer-events="none" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml" class="_jsPlumb_connector "><path d="M 0 40 C -10 90 -10 -50 0 0 " transform="translate(19.973323073622403,50.5)" pointer-events="visibleStroke" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="none" stroke="#316b31" style=""></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M-2.4569999999999963,49.16001999999999 L-8.714346841294152,28.91537600442066 L-10.77778447022079,37.90104376767174 L-19.973323073622403,37.23616047464146 L-2.4569999999999963,49.16001999999999" class="" stroke="#316b31" fill="#316b31" transform="translate(19.973323073622403,50.5)"></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M-2.4569999999999963,49.16001999999999 L-8.714346841294152,28.91537600442066 L-10.77778447022079,37.90104376767174 L-19.973323073622403,37.23616047464146 L-2.4569999999999963,49.16001999999999" class="" stroke="#316b31" fill="#316b31" transform="translate(19.973323073622403,50.5)"></path></svg><div class="_jsPlumb_overlay l1 component label" id="jsPlumb_1_637" style="position: absolute; transform: translate(-50%, -50%); left: 681px; top: 444.5px;">loop</div><svg style="position:absolute;left:583px;top:464.5px" width="134.875" height="87.4749984741211" pointer-events="none" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml" class="_jsPlumb_connector"><path d="M 113.875 86.4749984741211 C 123.875 36.474998474121094 -10 50 0 0 " transform="translate(10.5,0.5)" pointer-events="visibleStroke" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="none" stroke="#666" style=""></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M100.82289290624999,60.10066404356575 L86.59223330628966,44.40071731276259 L88.52182504966291,53.41607508180901 L79.90764434453293,56.70178516934967 L100.82289290624999,60.10066404356575" class="" stroke="#666" fill="#666" transform="translate(10.5,0.5)"></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M100.82289290624999,60.10066404356575 L86.59223330628966,44.40071731276259 L88.52182504966291,53.41607508180901 L79.90764434453293,56.70178516934967 L100.82289290624999,60.10066404356575" class="" stroke="#666" fill="#666" transform="translate(10.5,0.5)"></path></svg><svg style="position:absolute;left:756.875px;top:55.974998474121094px" width="102.75" height="496" pointer-events="none" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml" class="_jsPlumb_connector"><path d="M 81.75 0 C 91.75 50 -10 445 0 495 " transform="translate(10.5,0.5)" pointer-events="visibleStroke" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="none" stroke="#316b31" style=""></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M68.77267200000001,107.99712000000002 L71.96677479448137,128.94461883251668 L66.19248023355937,121.75730206450746 L58.206592729973934,126.36442706607602 L68.77267200000001,107.99712000000002" class="" stroke="#316b31" fill="#316b31" transform="translate(10.5,0.5)"></path><path pointer-events="all" version="1.1" xmlns="http://www.w3.org/1999/xhtml" d="M68.77267200000001,107.99712000000002 L71.96677479448137,128.94461883251668 L66.19248023355937,121.75730206450746 L58.206592729973934,126.36442706607602 L68.77267200000001,107.99712000000002" class="" stroke="#316b31" fill="#316b31" transform="translate(10.5,0.5)"></path></svg><div class="_jsPlumb_overlay l1 component label" id="jsPlumb_1_646" style="position: absolute; transform: translate(-50%, -50%); left: 807.75px; top: 303.475px;">loop</div><div class="_jsPlumb_endpoint source-endpoint dependency-source-endpoint connected _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 560.5px; top: 71px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint target-endpoint dependency-target-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 560.5px; top: 31px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint source-endpoint replicate-source-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected _jsPlumb_endpoint_full" style="position: absolute; height: 20px; width: 20px; left: 601px; top: 71px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#e5db3d" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint source-endpoint dependency-source-endpoint connected _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 549.5px; top: 199px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint target-endpoint replicate-target-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected _jsPlumb_endpoint_full" style="position: absolute; height: 20px; width: 20px; left: 586.4px; top: 159px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#e5db3d" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint target-endpoint dependency-target-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 549.5px; top: 159px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint source-endpoint dependency-source-endpoint connected _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 576.5px; top: 327px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint target-endpoint dependency-target-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 576.5px; top: 287px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint source-endpoint dependency-source-endpoint connected _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 583.5px; top: 455px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint target-endpoint dependency-target-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 583.5px; top: 415px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint source-endpoint loop-source-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected _jsPlumb_endpoint_full" style="position: absolute; height: 20px; width: 20px; left: 679px; top: 415px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#316b31" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint target-endpoint loop-target-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected _jsPlumb_endpoint_full" style="position: absolute; height: 20px; width: 20px; left: 679px; top: 455px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#316b31" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint source-endpoint dependency-source-endpoint connected _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable" style="position: absolute; height: 20px; width: 20px; left: 697.375px; top: 581.475px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint target-endpoint dependency-target-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 697.375px; top: 541.475px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint source-endpoint loop-source-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected _jsPlumb_endpoint_full" style="position: absolute; height: 20px; width: 20px; left: 757.375px; top: 541.475px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#316b31" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint source-endpoint dependency-source-endpoint connected _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected" style="position: absolute; height: 20px; width: 20px; left: 789.125px; top: 46.475px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#666" stroke="none" style=""></circle></svg></div><div class="_jsPlumb_endpoint target-endpoint loop-target-endpoint _jsPlumb_endpoint_anchor_ ui-draggable ui-droppable _jsPlumb_endpoint_connected _jsPlumb_endpoint_full" style="position: absolute; height: 20px; width: 20px; left: 839.125px; top: 46.475px;"><svg style="position:absolute;left:0px;top:0px" width="20" height="20" pointer-events="all" position="absolute" version="1.1" xmlns="http://www.w3.org/1999/xhtml"><circle cx="10" cy="10" r="10" version="1.1" xmlns="http://www.w3.org/1999/xhtml" fill="#316b31" stroke="none" style=""></circle></svg></div></div></div>
    </body>
</html>
 ]]>
    </visualization>
  </metadata>
</job>